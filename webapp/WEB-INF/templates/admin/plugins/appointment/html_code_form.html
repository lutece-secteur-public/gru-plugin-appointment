<div class="row">
	<div class="col-xs-12 col-sm-12 col-md-12 col-lg-12">
		<form class="form-horizontal" id="form-validate" action="jsp/admin/plugins/appointment/ManageAppointments.jsp" method="post" enctype="multipart/form-data">
			<input name="action" value="doValidateForm" type="hidden" />
			<input name="id_form" value="${form.idForm}" type="hidden" />
			<input type="hidden" name="date_of_display" value="${date_of_display}">
			<input name="session" value="session" type="hidden" />			
			<fieldset>
				<legend>
					<#if form.displayTitleFo && form.title != "" >
						${form.title}
					<#else>
						#i18n{appointment.appointmentApp.defaultTitle}
					</#if>
				</legend>
				<#if infos?? || errors??>
					<@messages infos=infos errors=errors />			
				</#if>
				<br>				
				<#if form_errors??>
					<#assign hasDisplayableError = false>
					<#list form_errors as form_error>
						<#if form_error.isDisplayableError>
							<#assign hasDisplayableError = true>
							<#break >
						</#if>
					</#list>
					<#if hasDisplayableError>
						<#list form_errors as form_error>	
							<#if form_error.isDisplayableError && form_error.errorMessage==listAllErrors[8] >
								<div class="alert alert-error alert-danger">
									<p>
									  	${form_error.errorMessage}
									</p>
								</div>
							</#if>	
						</#list>						
					</#if>
				</#if>				
				<#assign formGroupError = '' />
				<#if form_errors??>
					<#assign hasDisplayableError = false>
					<#list form_errors as form_error>
						<#if form_error.isDisplayableError>
							<#assign hasDisplayableError = true>
							<#break >
						</#if>
					</#list>
					<#if hasDisplayableError>
						<#list form_errors as form_error>	
							<#if form_error.isDisplayableError && form_error.errorMessage==listAllErrors[0]>
								<#assign formGroupError = '<span class="help-block">${form_error.errorMessage}</span>' />
							</#if>	
						</#list>
					</#if>
				</#if>
				<div class="form-group <#if formGroupError!=''>has-error</#if>">
					<label class="col-xs-12 col-sm-12 col-md-12 col-lg-12" for="lastname">${formMessages.fieldLastNameTitle!} *</label>
					<div class="col-xs-12 col-sm-12 col-md-12 col-lg-12">
						<input type="text" class="form-control" value="<#if appointment??>${appointment.lastName!}</#if>" maxlength="255" id="lastname" name="lastname">
						<#if formGroupError!=''>
							${formGroupError}
						<#else>
							<#if formMessages.fieldLastNameHelp?? && formMessages.fieldLastNameHelp != ''>
								<span class="help-block">${formMessages.fieldLastNameHelp}</span>
							</#if>
						</#if>
					</div>
				</div>								
				<#assign formGroupError = '' />
				<#if form_errors??>
					<#assign hasDisplayableError = false>
					<#list form_errors as form_error>
						<#if form_error.isDisplayableError>
							<#assign hasDisplayableError = true>
							<#break >
						</#if>
					</#list>
					<#if hasDisplayableError>
						<#list form_errors as form_error>	
							<#if form_error.isDisplayableError && form_error.errorMessage==listAllErrors[1]>
								<#assign formGroupError = '<span class="help-block">${form_error.errorMessage}</span>' />
							</#if>	
						</#list>
					</#if>
				</#if>
				<div class="form-group <#if formGroupError!=''>has-error</#if>">
					<label class="col-xs-12 col-sm-12 col-md-12 col-lg-12" for="firstname">${formMessages.fieldFirstNameTitle!} *</label>
					<div class="col-xs-12 col-sm-12 col-md-12 col-lg-12">
						<input type="text" class="form-control" value="<#if appointment??>${appointment.firstName!}</#if>" maxlength="255" id="firstname" name="firstname">
						<#if formGroupError!=''>
							${formGroupError}
						<#else>
							<#if formMessages.fieldFirstNameHelp?? && formMessages.fieldFirstNameHelp != ''>
								<span class="help-block">${formMessages.fieldLastNameHelp}</span>
							</#if>
						</#if>
					</div>
				</div>			
				<#assign formGroupError = '' />
				<#if form_errors??>
					<#assign hasDisplayableError = false>
					<#list form_errors as form_error>
						<#if form_error.isDisplayableError>
							<#assign hasDisplayableError = true>
							<#break >
						</#if>
					</#list>
					<#if hasDisplayableError>
						<#list form_errors as form_error>	
							<#if  form_error.isDisplayableError && (form_error.errorMessage==listAllErrors[2] || form_error.errorMessage==listAllErrors[3])>
								<#assign formGroupError = '<span class="help-block">${form_error.errorMessage}</span>' />
							</#if>	
						</#list>
					</#if>
				</#if>
				<div class="form-group <#if formGroupError!=''>has-error</#if>">
					<label class="col-xs-12 col-sm-12 col-md-12 col-lg-12" for="email">${formMessages.fieldEmailTitle!} <#if form.enableMandatoryEmail>*</#if></label>
					<div class="col-xs-12 col-sm-12 col-md-12 col-lg-12">
						<input type="text" class="form-control" value="<#if appointment??>${appointment.email!}</#if>" maxlength="255" id="email" name="email">
						<#if formGroupError!=''>
							${formGroupError}
						<#else>
							<#if formMessages.fieldEmailHelp?? && formMessages.fieldEmailHelp != ''>
								<span class="help-block">${formMessages.fieldEmailHelp}</span>
							</#if>
						</#if>
					</div>
				</div>											
				<#assign formGroupError = '' />
				<#if form_errors??>
					<#assign hasDisplayableError = false>
					<#list form_errors as form_error>
						<#if form_error.isDisplayableError>
							<#assign hasDisplayableError = true>
							<#break >
						</#if>
					</#list>
					<#if hasDisplayableError>
						<#list form_errors as form_error>	
							<#if form_error.isDisplayableError && (form_error.errorMessage == listAllErrors[4] || form_error.errorMessage == listAllErrors[5] )>
								<#assign formGroupError = '<span class="help-block">${form_error.errorMessage}</span>' />
							</#if>	
						</#list>
					</#if>
				</#if>
				<div class="form-group <#if formGroupError!=''>has-error</#if>">
					<label class="col-xs-12 col-sm-12 col-md-12 col-lg-12"for="emailConfirm">${formMessages.fieldConfirmationEmail!}<#if form.enableMandatoryEmail>*</#if></label>
					<div class="col-xs-12 col-sm-12 col-md-12 col-lg-12">
						<input type="text" value="<#if appointment??>${appointment.email!}</#if>" maxlength="255" id="emailConfirm" name="emailConfirm" class="form-control">
						<#if formGroupError!=''>
							${formGroupError}
						<#else>
							<#if formMessages.fieldConfirmationEmail?? && formMessages.fieldConfirmationEmailHelp != ''>
								<span class="help-block">${formMessages.fieldConfirmationEmailHelp!}</span>
							</#if>
						</#if>
					</div>
				</div>	
				<#if form.maxPeoplePerAppointment &gt; 1>				
					<#assign formGroupError = '' />
					<#if form_errors??>
						<#assign hasDisplayableError = false>
						<#list form_errors as form_error>
							<#if form_error.isDisplayableError>
								<#assign hasDisplayableError = true>
								<#break >
							</#if>
						</#list>
						<#if hasDisplayableError>
							<#list form_errors as form_error>	
								<#if form_error.isDisplayableError && (form_error.errorMessage==listAllErrors[6] || form_error.errorMessage == listAllErrors[7]) >
									<#assign formGroupError = '<span class="help-block">${form_error.errorMessage}</span>' />
								</#if>	
							</#list>
						</#if>
					</#if>
					<div class="form-group <#if formGroupError!=''>has-error</#if>">
						<label class="col-xs-12 col-sm-12 col-md-12 col-lg-12"for="nbBookedSeats">#i18n{appointment.createAppointmentForm.labelMaxPeoplePerAppointment}*</label>
						<div class="col-xs-12 col-sm-12 col-md-12 col-lg-12">
							<input type="text"  maxlength="3" id="nbBookedSeats" value="<#if appointment??>${appointment.nbBookedSeats!}</#if>" name="nbBookedSeats" class="form-control" onchange="this.value = minmax(this.value, 1, ${nbplaces})" onkeypress='return validateQty(event);'>
							<#if formGroupError!=''>
								${formGroupError}
							<#else>
								<#if nbplaces != 0 >
									<span class="help-block">${nbplaces!} place(s) maximum</span>
								</#if>
							</#if>
						</div>
					</div>	
				</#if>					
				${str_entry}
				${addon!}  
				<div class="form-group">
					<div class="col-xs-12 col-sm-offset-3 col-md-offset-3 col-lg-offset-3">
						<button class="btn btn-primary btn-sm" type="submit" name="save" >
							<i class="glyphicon glyphicon-ok"></i><span class="hidden-xs">&nbsp;#i18n{appointment.displayAppointmentForm.labelValidate}</span>
						</button>						
						<#if appointment.idAppointment &gt; 0>
							<a class="btn btn-primary btn-sm" href="jsp/admin/plugins/appointment/ManageAppointments.jsp?view=manageAppointments&id_form=${form.idForm}">
								<i class="glyphicon glyphicon-remove-circle"></i>&nbsp;#i18n{portal.util.labelBack}
							</a>
						<#else>
							<a class="btn btn-primary btn-sm" href="jsp/admin/plugins/appointment/ManageAppointments.jsp?view=viewCalendarManageAppointment&id_form=${form.idForm}&date_of_display=${date_of_display}">
								<i class="glyphicon glyphicon-remove-circle"></i>&nbsp;#i18n{portal.util.labelBack}
							</a>
						</#if>						
					</div>
				</div>				
			</fieldset>
		</form>
	</div>
</div>
<script type="text/javascript">
	function validateQty(event) {
		var key = window.event ? event.keyCode : event.which;
	
	if (event.keyCode == 8 || event.keyCode == 46
	 || event.keyCode == 37 || event.keyCode == 39) {
		return true;
	}
	else if ( key < 48 || key > 57 ) {
		return false;
	}
	else return true;
	};
   $(document).ready(function () {
      $('#emailConfirm').bind('paste', function (e) {
         e.preventDefault();
      });
   });
</script>